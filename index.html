<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dear Lottery Result</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin:0;
  font-family: system-ui;
  background: radial-gradient(circle at top, #1e293b, #020617);
  color: white;
}
header {
  padding:14px;
  background:#020617;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid #1e293b;
}
.logo { font-weight:700; }
.live { color:#22c55e; font-size:12px; }

.container {
  max-width:700px;
  margin:auto;
  padding:16px;
}

.card {
  background:#0f172a;
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 0 40px rgba(59,130,246,.2);
}

.poster {
  width:100%;
  cursor:pointer;
}

.info {
  padding:10px;
  display:flex;
  justify-content:space-between;
  font-size:14px;
}

.buttons {
  display:flex;
  gap:10px;
  margin-top:12px;
}

.btn {
  flex:1;
  background:#1e293b;
  border:none;
  color:white;
  padding:10px;
  border-radius:10px;
  cursor:pointer;
}

.history {
  margin-top:20px;
}

.history h3 {
  margin-bottom:10px;
}

.history-grid {
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}

.history img {
  width:100%;
  border-radius:8px;
  cursor:pointer;
}

#zoom {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  display:none;
  align-items:center;
  justify-content:center;
}
#zoom img {
  max-width:95%;
  max-height:95%;
}
</style>
</head>

<body>

<header>
  <div class="logo">DEAR LOTTERY</div>
  <div class="live">LIVE</div>
</header>

<div class="container">

  <div class="card">
    <img id="poster" class="poster">
    <div class="info">
      <div id="slot"></div>
      <div id="time"></div>
    </div>
  </div>

  <div class="buttons">
    <button class="btn" onclick="download()">Download</button>
    <button class="btn" onclick="location.reload()">Refresh</button>
  </div>

  <div class="history">
    <h3>Previous Results</h3>
    <div id="history" class="history-grid"></div>
  </div>

</div>

<div id="zoom" onclick="this.style.display='none'">
  <img id="zoomImg">
</div>

<script>
function getSlotKey() {
  const h = new Date().getHours();
  if (h < 13) return "1pm";
  if (h < 18) return "6pm";
  return "8pm";
}

function getSlotName() {
  const h = new Date().getHours();
  if (h < 13) return "1 PM DRAW";
  if (h < 18) return "6 PM DRAW";
  return "8 PM DRAW";
}

const today = new Date().toISOString().split("T")[0];
const slotKey = getSlotKey();
const posterUrl = "posters/" + today + "-" + slotKey + ".jpeg";

const poster = document.getElementById("poster");
poster.src = posterUrl;

poster.onclick = () => {
  document.getElementById("zoomImg").src = posterUrl;
  document.getElementById("zoom").style.display = "flex";
};

document.getElementById("slot").textContent = getSlotName();
document.getElementById("time").textContent = new Date().toLocaleString();

function download() {
  const a = document.createElement("a");
  a.href = posterUrl;
  a.download = posterUrl.split("/").pop();
  a.click();
}

/* Auto refresh every 2 minutes */
setInterval(() => location.reload(), 120000);

/* History */
const historyDiv = document.getElementById("history");
for (let i=1; i<=5; i++) {
  const d = new Date();
  d.setDate(d.getDate() - i);
  const day = d.toISOString().split("T")[0];
  ["1pm","6pm","8pm"].forEach(s => {
    const img = document.createElement("img");
    img.src = `posters/${day}-${s}.jpg`;
    img.onerror = () => img.style.display="none";
    img.onclick = () => {
      document.getElementById("zoomImg").src = img.src;
      document.getElementById("zoom").style.display = "flex";
    };
    historyDiv.appendChild(img);
  });
}
</script>

</body>
</html>
